---
title: "checking-data.Rmd"
output: html_document
date: "2022-12-01"
---
Chi-squad -- they need to redo right now.
##
```{r, echo=T}
library(bbmle)
setwd("~/Documents/ibio830/battles/2024")

md = read.csv('dragon.tree.data.csv')

plot(md$predictor, md$response)

invLink <- function(x){
  return(exp(x))
}
  
detFunc <- function(x,a,b){
	return(a*(x^b))
}


mod <- mle2(response ~ dpois(lambda=invLink(detFunc(predictor,a,b))),
             data=md,
             start=list("a"=1, "b"=2)
             )

mod




modData <- invLink(detFunc(myData$predictor, mod@coef[1], mod@coef[2]))

plot(myData$predictor, myData$response)
points(myData$predictor, 1/modData, col="red")

#plot(myData$predictor, detFunc(myData$predictor, a, b))
#plot(myData$predictor, 1/invLink(detFunc(myData$predictor, a, b)))
#plot(myData$predictor, rexp(1000, rate=invLink(detFunc(myData$predictor, a, b))))

##got

```

Ankit -- works with b=3 (the first scenario from the Rmarkdown doc)

```{r}
library(bbmle)

md = read.csv('~/Documents/ibio830/battles/2024/Ankit_simulated_data.csv')

plot(md$predictor, md$response)

invLink <- function(x){
  return(x)
}
  
detFunc <- function(x,a,b){
	return(a+x*b)
}


mod <- mle2(response ~ dnorm(mean=detFunc(predictor, a, b), sd=s),
             data=md,
             start=list("a"=1, "b"=2,'s'=1.5)
             )

mod




modData <- invLink(detFunc(md$predictor, mod@coef[1], mod@coef[2]))

plot(md$predictor, md$response)
points(md$predictor, modData, col="red")
```
