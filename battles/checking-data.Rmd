---
title: "checking-data.Rmd"
output: html_document
date: "2022-12-01"
---

Group silence of the lambdas 
##come back to this one
```{r, echo=F}
library(bbmle)
setwd("~/Documents/ibio830/battles/")

myData = read.csv('silence-of-the-lambdaslinear_data.csv')


a <- -1
b <- -.41 
  
detFunc <- function(x,a,b){
	return(a*x^b)
}

invLink <- function(z){
	return(-z^-1)
}



##
mod <- mle2(response ~ dexp(rate=invLink( detFunc(predictor,a,b))),
            data=myData,
            start=list("a"=0,"b"=0))

modData <- invLink(mod@coef[1]*myData$predictor^mod@coef[2])
modData1 <- invLink(a*myData$predictor^b)

plot(myData$predictor, myData$response)
points(myData$predictor, modData1, col="red")

```

Group R Bug
## come back to this

```{r}
myData <- read.csv('rbug-data.csv')

N0 <- 6
decay <- -0.18
  
detFunc <- function(x,a,b){
	return(a*x^b)
}

invLink <- function(z){
	return(exp(z))
}

mod <- mle2(response ~ dpois(lambda=invLink( detFunc(predictor,N0,decay))),
            data=myData,
            start=list("a"=6,"b"=-.18))


plot(myData$predictor, myData$response)

```

Team Hyrule
This one is good I think except for the weird detFunc -- how are they going to know about the 50?

```{r}
myData <- read.csv('Hyrule at Stats Data Simualtion.csv')

detFunc <- function(x,a,b){
  return(exp(-a*(x-b)))
}

# specify the inverse link function
invLink <- function(z){
  return(z)
}
a<-.06
b<-200
s=10

mod <- mle2(response ~ dnorm(mean=invLink( detFunc(predictor, a, b)), sd = s),
            data=myData,
            start=list("a"=0,"b"=200, s=10))

mod

```

Mice -- this one is good!

```{r}

myData=read.csv('mice_survive.csv')

invLink <- function(x){
  p <- 1/(1+exp(-x))
  return(p)
}

detFunc <- function(x,a,b){
	return(a+b*x)
}

a=0
b=1

## its an binom dist. But where's the deterministic function? Is it just linear and a is 0, b is 1?

mod <- mle2(Mice~ dbinom(size=20,prob=invLink( detFunc(temperature, a, b))),
            data=myData,
            start=list("a"=0,"b"=1))


modData <- invLink( detFunc(myData$temperature, a, b))*20
plot(myData$temperature, myData$Mice)
points(myData$temperature, modData, col="darkred")

```

Statfish

-- something is wrong here with how they calculated the counts -- each count is out of 1000.

```{r}
myData = read.csv('Statfish-data.csv')

detFunc <- function(x, a, b){
  resp <- exp(a + b*x)/1+exp(a+b*x)
  return(resp)
}

a = 1
b = 0.01

invLink <- function(x){
 exp(x)
}


mod <- mle2(Mice~ dpois(lambda=invLink( detFunc(temperature, a, b))),
            data=myData,
            start=list("a"=1,"b"=0.01))
mod


```